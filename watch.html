<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Video App UI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <link
      href="https://fonts.googleapis.com/css?family=DM+Sans:400,500,700&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/flv.js/1.6.2/flv.min.js"
      integrity="sha512-49OFf+8jaHx4Vb7iFNb46Loq1pIxXlEYeVOQRIx0KLBRF4KSV6E7QK2Vw5r416TQDyBJW+DFh2CyTV7+gCWd6g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <!-- <script src="/flv.js"></script> -->
  </head>
  <body class="dark">
    <div class="app-container">
      <button id="setting" class="hidden"></button>
      <button class="mode-switch">
        <svg
          class="sun"
          fill="none"
          stroke="#fbb046"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          class="feather feather-sun"
          viewBox="0 0 24 24"
        >
          <defs />
          <circle cx="12" cy="12" r="5" />
          <path
            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
          />
        </svg>
        <svg
          class="moon"
          fill="none"
          stroke="#ffffff"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          class="feather feather-moon"
          viewBox="0 0 24 24"
        >
          <defs />
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
        </svg>
      </button>
      <div class="app-main">
        <div class="video-call-wrapper" style="background-color: #000000">
          <div class="video-participant">
            <a class="status" style="z-index: 99; display: flex; align-items: center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="feather feather-users"
              >
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <span style="padding: 5px 8px; border-radius: 100%" id="livecount">0</span></a
            >
            <div class="participant-actions">
              <button class="btn-mute hidden"></button>
              <button class="btn-camera hidden"></button>
            </div>
            <video id="video1" autoplay controls muted style="height: 100%; width: 100%"></video>
          </div>
        </div>
        <div class="video-call-actions hidden">
          <button class="video-action-button play" id="play-btn"></button>
          <!-- <button class="video-action-button pause" id="camera-btn"></button> -->
          <button class="video-action-button maximize" onclick="window.fullScreen()"></button>
        </div>
      </div>
      <div class="right-side">
        <button class="btn-close-right">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            class="feather feather-x-circle"
            viewBox="0 0 24 24"
          >
            <defs></defs>
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M15 9l-6 6M9 9l6 6"></path>
          </svg>
        </button>
        <div class="chat-container">
          <div class="chat-header">
            <button class="chat-header-button">Live Chat</button>
          </div>
          <div class="chat-area"></div>
          <div class="chat-typing-area-wrapper">
            <div class="chat-typing-area">
              <input type="text" placeholder="Type your message..." class="chat-input" />
              <button class="send-button">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="feather feather-send"
                  viewBox="0 0 24 24"
                >
                  <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
      <button class="expand-btn">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather feather-message-circle"
        >
          <path
            d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"
          />
        </svg>
      </button>
    </div>
    <!-- The Modal -->
    <div id="setting-modal" class="modal hidden">
      <!-- Modal content -->
      <div class="modal-content">
        <div style="display: flex; flex-direction: column">
          <label for="res">Video Resolution</label>
          <select id="res" class="input-text">
            <option value="">Default</option>
          </select>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="./script.js"></script>
    <script>
      var videoElement = document.getElementById("video1");
      var flvPlayer;
      let protocol = location.protocol == "http:" ? "ws" : "wss";
      let port = location.protocol == "http:" ? "8000" : "8443";
      function streamLt(strname) {
        let strLink = `${protocol}://${location.hostname}:${port}/live/${strname}.flv`;
        console.log(strLink);
        if (flvjs.isSupported()) {
          flvPlayer = flvjs.createPlayer({
            type: "flv",
            isLive: true,
            url: strLink,
          });
          flvPlayer.attachMediaElement(videoElement);
          flvPlayer.load();
          flvPlayer.play();
          document.querySelector("#play-btn").classList.remove("play");
          document.querySelector("#play-btn").classList.add("pause");
        }
      }
      function pause() {
        flvPlayer.pause();
        document.querySelector("#play-btn").classList.remove("pause");
        document.querySelector("#play-btn").classList.add("play");
      }

      function play() {
        let urlinfo = new URLSearchParams(location.search);
        let strname = urlinfo.get("stream");
        if (strname !== "") {
          streamLt(strname);
          return;
        }
        alert("Stream Name Can't be Empty");
        // location.replace = '/'
      }

      function fullScreen() {
        if (videoElement.requestFullscreen) {
          videoElement.requestFullscreen();
        } else if (videoElement.mozRequestFullScreen) {
          videoElement.mozRequestFullScreen();
        } else if (videoElement.webkitRequestFullscreen) {
          videoElement.webkitRequestFullscreen();
        } else if (videoElement.msRequestFullscreen) {
          videoElement.msRequestFullscreen();
        }
      }

      document.getElementById("play-btn").addEventListener("click", function (e) {
        let isStartBtn = e.target.className.includes("play");
        if (isStartBtn) {
          play();
          return;
        }
        pause();
      });
      document.addEventListener("DOMContentLoaded", function (event) {
        //the event occurred
        window.play();
      });
    </script>
    <!-- <script src="./control.js"></script> -->
  </body>
</html>
